[build]
builder = "nixpacks"
buildCommand = "npm install && cd packages/db && npm run build && cd ../../apps/api && npm run build"

[deploy]
# Run migrations at startup, then start the server
startCommand = "cd packages/db && npx prisma migrate deploy && cd ../../apps/api && npm start"
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 10
healthcheckPath = "/health"
healthcheckTimeout = 300

